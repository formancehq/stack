version: '3'

env:
  LOG_LEVEL: "debug"

vars:
  SERVICE: "wallets"
  APP_VERSION: "develop"
  APP_SHA: "ksjfsldkf"

  PKG: "./..."
  FAILFAST: "-failfast"
  TIMEOUT: "1m"
  RUN: ".*"
  VERBOSE: "false"

tasks:
  default:
    cmds:
      - task: lint
      - task: tests

  lint:
    cmds:
      - golangci-lint run -v --fix

  tests:
    cmds:
      - go test -race -coverpkg {{.PKG}} -coverprofile coverage.out {{if eq .VERBOSE "true"}}-v{{end}} {{.PKG}}
