---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.9.2
  creationTimestamp: null
  name: configurations.stack.formance.com
spec:
  group: stack.formance.com
  names:
    kind: Configuration
    listKind: ConfigurationList
    plural: configurations
    singular: configuration
  scope: Cluster
  versions:
  - name: v1beta3
    schema:
      openAPIV3Schema:
        description: Configuration is the Schema for the configurations API
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            properties:
              auth:
                properties:
                  checkScopes:
                    type: boolean
                  readKeySetMaxRetries:
                    type: integer
                type: object
              broker:
                properties:
                  kafka:
                    properties:
                      brokers:
                        items:
                          type: string
                        type: array
                      sasl:
                        properties:
                          mechanism:
                            type: string
                          password:
                            type: string
                          scramSHASize:
                            type: string
                          username:
                            type: string
                        required:
                        - mechanism
                        - scramSHASize
                        type: object
                      tls:
                        type: boolean
                    required:
                    - brokers
                    type: object
                  nats:
                    properties:
                      replicas:
                        default: 3
                        type: integer
                      url:
                        type: string
                    required:
                    - url
                    type: object
                type: object
              ingress:
                properties:
                  annotations:
                    additionalProperties:
                      type: string
                    type: object
                  tls:
                    properties:
                      secretName:
                        description: SecretName is the name of the secret used to
                          terminate TLS traffic on port 443. Field is left optional
                          to allow TLS routing based on SNI hostname alone. If the
                          SNI host in a listener conflicts with the "Host" header
                          field used by an IngressRule, the SNI host is used for termination
                          and value of the Host header is used for routing.
                        type: string
                    type: object
                type: object
              light:
                description: LightMode is experimental and indicate we want monopods
                type: boolean
              monitoring:
                properties:
                  metrics:
                    properties:
                      otlp:
                        properties:
                          endpoint:
                            type: string
                          insecure:
                            type: boolean
                          mode:
                            enum:
                            - grpc
                            - http
                            type: string
                          port:
                            format: int32
                            type: integer
                          resourceAttributes:
                            type: string
                        type: object
                    type: object
                  traces:
                    properties:
                      otlp:
                        properties:
                          endpoint:
                            type: string
                          insecure:
                            type: boolean
                          mode:
                            enum:
                            - grpc
                            - http
                            type: string
                          port:
                            format: int32
                            type: integer
                          resourceAttributes:
                            type: string
                        type: object
                    type: object
                type: object
              registries:
                additionalProperties:
                  properties:
                    endpoint:
                      type: string
                  required:
                  - endpoint
                  type: object
                type: object
              services:
                description: ConfigurationServicesSpec define all existing services
                  for a stack. Fields order is important. For example, auth must be
                  defined later as other services create static auth clients which
                  must be used by auth.
                properties:
                  auth:
                    properties:
                      annotations:
                        properties:
                          service:
                            additionalProperties:
                              type: string
                            type: object
                        type: object
                      debug:
                        type: boolean
                      dev:
                        type: boolean
                      postgres:
                        properties:
                          credentialsFromSecret:
                            type: string
                          debug:
                            type: boolean
                          disableSSLMode:
                            type: boolean
                          host:
                            type: string
                          password:
                            type: string
                          port:
                            type: integer
                          username:
                            type: string
                        required:
                        - host
                        - port
                        type: object
                      resourceProperties:
                        properties:
                          limits:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                          request:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                        type: object
                      staticClients:
                        items:
                          properties:
                            description:
                              type: string
                            id:
                              type: string
                            postLogoutRedirectUris:
                              items:
                                type: string
                              type: array
                            public:
                              type: boolean
                            redirectUris:
                              items:
                                type: string
                              type: array
                            scopes:
                              items:
                                type: string
                              type: array
                            secrets:
                              items:
                                type: string
                              type: array
                          required:
                          - id
                          type: object
                        type: array
                    required:
                    - postgres
                    type: object
                  control:
                    properties:
                      annotations:
                        properties:
                          service:
                            additionalProperties:
                              type: string
                            type: object
                        type: object
                      debug:
                        type: boolean
                      dev:
                        type: boolean
                      disabled:
                        type: boolean
                      resourceProperties:
                        properties:
                          limits:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                          request:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                        type: object
                    type: object
                  gateway:
                    properties:
                      annotations:
                        properties:
                          service:
                            additionalProperties:
                              type: string
                            type: object
                        type: object
                      enableAuditPlugin:
                        type: boolean
                      enableScopes:
                        type: boolean
                      fallback:
                        type: string
                      livenessEndpoint:
                        type: string
                      resourceProperties:
                        properties:
                          limits:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                          request:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                        type: object
                    type: object
                  ledger:
                    properties:
                      allowPastTimestamps:
                        type: boolean
                      annotations:
                        properties:
                          service:
                            additionalProperties:
                              type: string
                            type: object
                        type: object
                      debug:
                        type: boolean
                      deploymentStrategy:
                        type: string
                      dev:
                        type: boolean
                      disabled:
                        type: boolean
                      locking:
                        properties:
                          redis:
                            properties:
                              duration:
                                description: A Duration represents the elapsed time
                                  between two instants as an int64 nanosecond count.
                                  The representation limits the largest representable
                                  duration to approximately 290 years.
                                format: int64
                                type: integer
                              insecure:
                                type: boolean
                              retry:
                                description: A Duration represents the elapsed time
                                  between two instants as an int64 nanosecond count.
                                  The representation limits the largest representable
                                  duration to approximately 290 years.
                                format: int64
                                type: integer
                              tls:
                                type: boolean
                              uri:
                                type: string
                            type: object
                          strategy:
                            default: memory
                            type: string
                        type: object
                      postgres:
                        properties:
                          credentialsFromSecret:
                            type: string
                          debug:
                            type: boolean
                          disableSSLMode:
                            type: boolean
                          host:
                            type: string
                          password:
                            type: string
                          port:
                            type: integer
                          username:
                            type: string
                        required:
                        - host
                        - port
                        type: object
                      resourceProperties:
                        properties:
                          limits:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                          request:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                        type: object
                    required:
                    - postgres
                    type: object
                  orchestration:
                    properties:
                      annotations:
                        properties:
                          service:
                            additionalProperties:
                              type: string
                            type: object
                        type: object
                      debug:
                        type: boolean
                      dev:
                        type: boolean
                      disabled:
                        type: boolean
                      postgres:
                        properties:
                          credentialsFromSecret:
                            type: string
                          debug:
                            type: boolean
                          disableSSLMode:
                            type: boolean
                          host:
                            type: string
                          password:
                            type: string
                          port:
                            type: integer
                          username:
                            type: string
                        required:
                        - host
                        - port
                        type: object
                      resourceProperties:
                        properties:
                          limits:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                          request:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                        type: object
                    required:
                    - postgres
                    type: object
                  payments:
                    properties:
                      annotations:
                        properties:
                          service:
                            additionalProperties:
                              type: string
                            type: object
                        type: object
                      debug:
                        type: boolean
                      dev:
                        type: boolean
                      disabled:
                        type: boolean
                      encryptionKey:
                        type: string
                      postgres:
                        properties:
                          credentialsFromSecret:
                            type: string
                          debug:
                            type: boolean
                          disableSSLMode:
                            type: boolean
                          host:
                            type: string
                          password:
                            type: string
                          port:
                            type: integer
                          username:
                            type: string
                        required:
                        - host
                        - port
                        type: object
                      resourceProperties:
                        properties:
                          limits:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                          request:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                        type: object
                    required:
                    - encryptionKey
                    - postgres
                    type: object
                  reconciliation:
                    properties:
                      annotations:
                        properties:
                          service:
                            additionalProperties:
                              type: string
                            type: object
                        type: object
                      debug:
                        type: boolean
                      dev:
                        type: boolean
                      disabled:
                        type: boolean
                      postgres:
                        properties:
                          credentialsFromSecret:
                            type: string
                          debug:
                            type: boolean
                          disableSSLMode:
                            type: boolean
                          host:
                            type: string
                          password:
                            type: string
                          port:
                            type: integer
                          username:
                            type: string
                        required:
                        - host
                        - port
                        type: object
                      resourceProperties:
                        properties:
                          limits:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                          request:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                        type: object
                    required:
                    - postgres
                    type: object
                  search:
                    properties:
                      annotations:
                        properties:
                          service:
                            additionalProperties:
                              type: string
                            type: object
                        type: object
                      batching:
                        properties:
                          count:
                            type: integer
                          period:
                            type: string
                        required:
                        - count
                        - period
                        type: object
                      benthosResourceProperties:
                        properties:
                          limits:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                          request:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                        type: object
                      debug:
                        type: boolean
                      dev:
                        type: boolean
                      disabled:
                        type: boolean
                      elasticSearch:
                        properties:
                          basicAuth:
                            properties:
                              password:
                                type: string
                              secretName:
                                type: string
                              username:
                                type: string
                            type: object
                          host:
                            type: string
                          pathPrefix:
                            type: string
                          port:
                            type: integer
                          scheme:
                            enum:
                            - http
                            - https
                            type: string
                          tls:
                            properties:
                              enabled:
                                type: boolean
                              skipCertVerify:
                                type: boolean
                            type: object
                          useZinc:
                            type: boolean
                        type: object
                      searchResourceProperties:
                        properties:
                          limits:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                          request:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                        type: object
                    required:
                    - elasticSearch
                    type: object
                  stargate:
                    properties:
                      annotations:
                        properties:
                          service:
                            additionalProperties:
                              type: string
                            type: object
                        type: object
                      debug:
                        type: boolean
                      dev:
                        type: boolean
                      resourceProperties:
                        properties:
                          limits:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                          request:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                        type: object
                    type: object
                  wallets:
                    properties:
                      annotations:
                        properties:
                          service:
                            additionalProperties:
                              type: string
                            type: object
                        type: object
                      debug:
                        type: boolean
                      dev:
                        type: boolean
                      disabled:
                        type: boolean
                      resourceProperties:
                        properties:
                          limits:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                          request:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                        type: object
                    type: object
                  webhooks:
                    properties:
                      annotations:
                        properties:
                          service:
                            additionalProperties:
                              type: string
                            type: object
                        type: object
                      debug:
                        type: boolean
                      dev:
                        type: boolean
                      disabled:
                        type: boolean
                      postgres:
                        properties:
                          credentialsFromSecret:
                            type: string
                          debug:
                            type: boolean
                          disableSSLMode:
                            type: boolean
                          host:
                            type: string
                          password:
                            type: string
                          port:
                            type: integer
                          username:
                            type: string
                        required:
                        - host
                        - port
                        type: object
                      resourceProperties:
                        properties:
                          limits:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                          request:
                            properties:
                              cpu:
                                type: string
                              memory:
                                type: string
                            type: object
                        type: object
                    required:
                    - postgres
                    type: object
                type: object
              temporal:
                properties:
                  address:
                    type: string
                  namespace:
                    type: string
                  tls:
                    description: 'TODO: Handle validation'
                    properties:
                      crt:
                        type: string
                      key:
                        type: string
                      secretName:
                        type: string
                    type: object
                required:
                - address
                - namespace
                type: object
            required:
            - broker
            - services
            - temporal
            type: object
          status:
            properties:
              conditions:
                items:
                  properties:
                    lastTransitionTime:
                      description: lastTransitionTime is the last time the condition
                        transitioned from one status to another. This should be when
                        the underlying condition changed.  If that is not known, then
                        using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: message is a human readable message indicating
                        details about the transition. This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: observedGeneration represents the .metadata.generation
                        that the condition was set based upon. For instance, if .metadata.generation
                        is currently 12, but the .status.conditions[x].observedGeneration
                        is 9, the condition is out of date with respect to the current
                        state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                        --- Many .condition.type values are consistent across resources
                        like Available, but because arbitrary conditions can be useful
                        (see .node.status.conditions), the ability to deconflict is
                        important. The regex it matches is (dns1123SubdomainFmt/)?(qualifiedNameFmt)
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - status
                  - type
                  type: object
                type: array
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
