
# ---
# kind: Build
# type: exec
# name: build-operator-image
# # source:
# #   path: ../../
# spec:
#   command:
#     - sh
#     - -c
#     - make docker-build 
# ---
# kind: Build
# type: exec
# name: push-operator-image
# dependencies:
#   - build.build-operator-image
# spec:
#   command:
#     - sh
#     - -c
#     - make docker-push
---
kind: Build
type: exec
name: generate-helm-chart
# dependencies:
#   - build.push-operator-image
spec:
  command:
    - sh
    - -c
    - make kustomize
---
kind: Deploy
type: helm
description: Operator Helm deploy
name: formance-operator
dependencies:
  - build.generate-helm-chart
spec:
  namespace: formance-system
  chart:
    path: ./helm
  values:
    image:
      repository: k3d-registry.host.k3d.internal:12345/operator
      tag: dev-latest
# sync:
# description: First step to build the operator dev image
# allowPublish: false
# source:
#   path: .
# spec:
#   localId: operator
#   dockerfile: ./components/operator/garden.Dockerfile
#   targetStage: reloader
